<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Overlay Controller</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: -apple-system, system-ui, sans-serif; padding:30px; max-width:700px; margin:0 auto; background:#f5f5f5;}
    .section { background:#fff; padding:25px; border-radius:10px; margin-bottom:20px; box-shadow:0 2px 8px rgba(0,0,0,.08);}
    input, textarea { width:100%; padding:12px; margin:10px 0; border:1px solid #ddd; border-radius:8px; font-size:16px;}
    button { padding:12px 18px; border:0; border-radius:8px; background:#007aff; color:#fff; font-weight:600; margin-right:8px;}
    button.secondary { background:#8e8e93; }
    .presets { display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;}
    .presets button { background:#34c759; }
  </style>
</head>
<body>
  <h1>Overlay Controller</h1>
  <div class="section">
    <h3>Lower Third</h3>
    <input id="lowerThird" placeholder="Your Name â€” Title" />
    <div>
      <button onclick="updateLowerThird()">Update</button>
      <button class="secondary" onclick="clearLowerThird()">Clear</button>
    </div>
  </div>
  <div class="section">
    <h3>Bullet Points</h3>
    <textarea id="bullets" rows="6" placeholder="One per line"></textarea>
    <div>
      <button onclick="updateBullets()">Update</button>
      <button class="secondary" onclick="clearBullets()">Clear</button>
    </div>
    <div class="presets">
      <button onclick="loadPreset('realestate')">Real Estate</button>
      <button onclick="loadPreset('podcast')">Podcast</button>
      <button onclick="loadPreset('presentation')">Presentation</button>
    </div>
  </div>
  <script>
    const sid = window.location.pathname.split('/')[2] || 'demo';
    const presets = {
      realestate: { bullets: ['Why now is the right time','Market conditions','Investment angle','Next steps']},
      podcast: { bullets: ['Guest intro','Key points','CTA','Where to follow']},
      presentation: { bullets: ['Problem','Solution','Benefits','Implementation']}
    };
    async function fetchState(){ const r=await fetch(`/api/overlay/${sid}/state`); return r.json();}
    async function postState(state){ await fetch(`/api/overlay/${sid}/state`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(state)}); }
    async function updateLowerThird(){
      const text=document.getElementById('lowerThird').value;
      const s=await fetchState(); s.lowerThird=text; await postState(s);
    }
    async function clearLowerThird(){ const s=await fetchState(); s.lowerThird=null; await postState(s); document.getElementById('lowerThird').value=''; }
    async function updateBullets(){ const s=await fetchState(); s.bullets=document.getElementById('bullets').value.split('\n').filter(Boolean); await postState(s); }
    async function clearBullets(){ const s=await fetchState(); s.bullets=[]; await postState(s); document.getElementById('bullets').value=''; }
    function loadPreset(k){ const p=presets[k]; if(p){ document.getElementById('bullets').value=p.bullets.join('\n'); } }
  </script>
</body>
</html>
