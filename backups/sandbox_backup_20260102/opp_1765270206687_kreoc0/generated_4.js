**NOTE: Always sanitize input data to prevent SQL injection or other forms of attacks, and ensure that your database credentials are stored securely using environment variables as demonstrated above for JWT secret key retrieval. Additionally, consider rate limiting on API endpoints like registration/login where possible to mitigate brute force attacks.**

### Refactored Code for User Login ###